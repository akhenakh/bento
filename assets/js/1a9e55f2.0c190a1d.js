"use strict";(self.webpackChunkbento=self.webpackChunkbento||[]).push([[8127],{19989:function(e,n,t){t.r(n),t.d(n,{assets:function(){return u},contentTitle:function(){return i},default:function(){return h},frontMatter:function(){return o},metadata:function(){return c},toc:function(){return d}});var r=t(85893),l=t(11151),s=t(74866),a=t(85162);const o={title:"gcp_bigquery_select",slug:"gcp_bigquery_select",type:"input",status:"beta",categories:["Services","GCP"],name:"gcp_bigquery_select"},i=void 0,c={id:"components/inputs/gcp_bigquery_select",title:"gcp_bigquery_select",description:"\x3c!--",source:"@site/docs/components/inputs/gcp_bigquery_select.md",sourceDirName:"components/inputs",slug:"/components/inputs/gcp_bigquery_select",permalink:"/docs/components/inputs/gcp_bigquery_select",draft:!1,unlisted:!1,editUrl:"https://github.com/warpstreamlabs/bento/edit/main/website/docs/components/inputs/gcp_bigquery_select.md",tags:[],version:"current",frontMatter:{title:"gcp_bigquery_select",slug:"gcp_bigquery_select",type:"input",status:"beta",categories:["Services","GCP"],name:"gcp_bigquery_select"},sidebar:"docs",previous:{title:"file",permalink:"/docs/components/inputs/file"},next:{title:"gcp_cloud_storage",permalink:"/docs/components/inputs/gcp_cloud_storage"}},u={},d=[{value:"Examples",id:"examples",level:2},{value:"Fields",id:"fields",level:2},{value:"<code>project</code>",id:"project",level:3},{value:"<code>table</code>",id:"table",level:3},{value:"<code>columns</code>",id:"columns",level:3},{value:"<code>where</code>",id:"where",level:3},{value:"<code>auto_replay_nacks</code>",id:"auto_replay_nacks",level:3},{value:"<code>job_labels</code>",id:"job_labels",level:3},{value:"<code>priority</code>",id:"priority",level:3},{value:"<code>args_mapping</code>",id:"args_mapping",level:3},{value:"<code>prefix</code>",id:"prefix",level:3},{value:"<code>suffix</code>",id:"suffix",level:3}];function p(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,l.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.admonition,{title:"BETA",type:"caution",children:(0,r.jsx)(n.p,{children:"This component is mostly stable but breaking changes could still be made outside of major version releases if a fundamental problem with the component is found."})}),"\n",(0,r.jsxs)(n.p,{children:["Executes a ",(0,r.jsx)(n.code,{children:"SELECT"})," query against BigQuery and creates a message for each row received."]}),"\n",(0,r.jsx)(n.p,{children:"Introduced in version 3.63.0."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:'# Config fields, showing default values\ninput:\n  label: ""\n  gcp_bigquery_select:\n    project: "" # No default (required)\n    table: bigquery-public-data.samples.shakespeare # No default (required)\n    columns: [] # No default (required)\n    where: type = ? and created_at > ? # No default (optional)\n    auto_replay_nacks: true\n    job_labels: {}\n    priority: ""\n    args_mapping: root = [ "article", now().ts_format("2006-01-02") ] # No default (optional)\n    prefix: "" # No default (optional)\n    suffix: "" # No default (optional)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Once the rows from the query are exhausted, this input shuts down, allowing the pipeline to gracefully terminate (or the next input in a ",(0,r.jsx)(n.a,{href:"/docs/components/inputs/sequence",children:"sequence"})," to execute)."]}),"\n",(0,r.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(s.Z,{defaultValue:"Word counts",values:[{label:"Word counts",value:"Word counts"}],children:(0,r.jsxs)(a.Z,{value:"Word counts",children:[(0,r.jsx)(n.p,{children:"Here we query the public corpus of Shakespeare's works to generate a stream of the top 10 words that are 3 or more characters long:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"input:\n  gcp_bigquery_select:\n    project: sample-project\n    table: bigquery-public-data.samples.shakespeare\n    columns:\n      - word\n      - sum(word_count) as total_count\n    where: length(word) >= ?\n    suffix: |\n      GROUP BY word\n      ORDER BY total_count DESC\n      LIMIT 10\n    args_mapping: |\n      root = [ 3 ]\n"})})]})}),"\n",(0,r.jsx)(n.h2,{id:"fields",children:"Fields"}),"\n",(0,r.jsx)(n.h3,{id:"project",children:(0,r.jsx)(n.code,{children:"project"})}),"\n",(0,r.jsx)(n.p,{children:"GCP project where the query job will execute."}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"})]}),"\n",(0,r.jsx)(n.h3,{id:"table",children:(0,r.jsx)(n.code,{children:"table"})}),"\n",(0,r.jsx)(n.p,{children:"Fully-qualified BigQuery table name to query."}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:"# Examples\n\ntable: bigquery-public-data.samples.shakespeare\n"})}),"\n",(0,r.jsx)(n.h3,{id:"columns",children:(0,r.jsx)(n.code,{children:"columns"})}),"\n",(0,r.jsx)(n.p,{children:"A list of columns to query."}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"array"})]}),"\n",(0,r.jsx)(n.h3,{id:"where",children:(0,r.jsx)(n.code,{children:"where"})}),"\n",(0,r.jsxs)(n.p,{children:["An optional where clause to add. Placeholder arguments are populated with the ",(0,r.jsx)(n.code,{children:"args_mapping"})," field. Placeholders should always be question marks (",(0,r.jsx)(n.code,{children:"?"}),")."]}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:"# Examples\n\nwhere: type = ? and created_at > ?\n\nwhere: user_id = ?\n"})}),"\n",(0,r.jsx)(n.h3,{id:"auto_replay_nacks",children:(0,r.jsx)(n.code,{children:"auto_replay_nacks"})}),"\n",(0,r.jsxs)(n.p,{children:["Whether messages that are rejected (nacked) at the output level should be automatically replayed indefinitely, eventually resulting in back pressure if the cause of the rejections is persistent. If set to ",(0,r.jsx)(n.code,{children:"false"})," these messages will instead be deleted. Disabling auto replays can greatly improve memory efficiency of high throughput streams as the original shape of the data can be discarded immediately upon consumption and mutation."]}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"bool"}),(0,r.jsx)(n.br,{}),"\n","Default: ",(0,r.jsx)(n.code,{children:"true"})]}),"\n",(0,r.jsx)(n.h3,{id:"job_labels",children:(0,r.jsx)(n.code,{children:"job_labels"})}),"\n",(0,r.jsx)(n.p,{children:"A list of labels to add to the query job."}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"object"}),(0,r.jsx)(n.br,{}),"\n","Default: ",(0,r.jsx)(n.code,{children:"{}"})]}),"\n",(0,r.jsx)(n.h3,{id:"priority",children:(0,r.jsx)(n.code,{children:"priority"})}),"\n",(0,r.jsx)(n.p,{children:"The priority with which to schedule the query."}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"}),(0,r.jsx)(n.br,{}),"\n","Default: ",(0,r.jsx)(n.code,{children:'""'})]}),"\n",(0,r.jsx)(n.h3,{id:"args_mapping",children:(0,r.jsx)(n.code,{children:"args_mapping"})}),"\n",(0,r.jsxs)(n.p,{children:["An optional ",(0,r.jsx)(n.a,{href:"/docs/guides/bloblang/about",children:"Bloblang mapping"})," which should evaluate to an array of values matching in size to the number of placeholder arguments in the field ",(0,r.jsx)(n.code,{children:"where"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:'# Examples\n\nargs_mapping: root = [ "article", now().ts_format("2006-01-02") ]\n'})}),"\n",(0,r.jsx)(n.h3,{id:"prefix",children:(0,r.jsx)(n.code,{children:"prefix"})}),"\n",(0,r.jsx)(n.p,{children:"An optional prefix to prepend to the select query (before SELECT)."}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"})]}),"\n",(0,r.jsx)(n.h3,{id:"suffix",children:(0,r.jsx)(n.code,{children:"suffix"})}),"\n",(0,r.jsx)(n.p,{children:"An optional suffix to append to the select query."}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"})]})]})}function h(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},85162:function(e,n,t){t.d(n,{Z:function(){return a}});t(67294);var r=t(86010),l={tabItem:"tabItem_Ymn6"},s=t(85893);function a(e){let{children:n,hidden:t,className:a}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.Z)(l.tabItem,a),hidden:t,children:n})}},74866:function(e,n,t){t.d(n,{Z:function(){return _}});var r=t(67294),l=t(86010),s=t(12466),a=t(16550),o=t(20469),i=t(91980),c=t(67392),u=t(50012);function d(e){var n,t;return null!=(n=null==(t=r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?n:[]}function p(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=null!=n?n:function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:l}}=e;return{value:n,label:t,attributes:r,default:l}}))}(t);return function(e){const n=(0,c.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,t])}function h(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function f(e){let{queryString:n=!1,groupId:t}=e;const l=(0,a.k6)(),s=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:t});return[(0,i._X)(s),(0,r.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(l.location.search);n.set(s,e),l.replace({...l.location,search:n.toString()})}),[s,l])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:l}=e,s=p(e),[a,i]=(0,r.useState)((()=>function(e){var n;let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:r}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+r.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}const l=null!=(n=r.find((e=>e.default)))?n:r[0];if(!l)throw new Error("Unexpected error: 0 tabValues");return l.value}({defaultValue:n,tabValues:s}))),[c,d]=f({queryString:t,groupId:l}),[m,b]=function(e){let{groupId:n}=e;const t=function(e){return e?"docusaurus.tab."+e:null}(n),[l,s]=(0,u.Nk)(t);return[l,(0,r.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:l}),g=(()=>{const e=null!=c?c:m;return h({value:e,tabValues:s})?e:null})();(0,o.Z)((()=>{g&&i(g)}),[g]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error("Can't select invalid tab value="+e);i(e),d(e),b(e)}),[d,b,s]),tabValues:s}}var b=t(72389),g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"},x=t(85893);function j(e){let{className:n,block:t,selectedValue:r,selectValue:a,tabValues:o}=e;const i=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.o5)(),u=e=>{const n=e.currentTarget,t=i.indexOf(n),l=o[t].value;l!==r&&(c(n),a(l))},d=e=>{var n;let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{var r;const n=i.indexOf(e.currentTarget)+1;t=null!=(r=i[n])?r:i[0];break}case"ArrowLeft":{var l;const n=i.indexOf(e.currentTarget)-1;t=null!=(l=i[n])?l:i[i.length-1];break}}null==(n=t)||n.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:s}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>i.push(e),onKeyDown:d,onClick:u,...s,className:(0,l.Z)("tabs__item",g.tabItem,null==s?void 0:s.className,{"tabs__item--active":r===n}),children:null!=t?t:n},n)}))})}function y(e){let{lazy:n,children:t,selectedValue:l}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===l));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==l})))})}function v(e){const n=m(e);return(0,x.jsxs)("div",{className:(0,l.Z)("tabs-container",g.tabList),children:[(0,x.jsx)(j,{...e,...n}),(0,x.jsx)(y,{...e,...n})]})}function _(e){const n=(0,b.Z)();return(0,x.jsx)(v,{...e,children:d(e.children)},String(n))}},11151:function(e,n,t){t.d(n,{Z:function(){return o},a:function(){return a}});var r=t(67294);const l={},s=r.createContext(l);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);