"use strict";(self.webpackChunkbento=self.webpackChunkbento||[]).push([[6276],{2331:function(e,n,t){t.r(n),t.d(n,{assets:function(){return l},contentTitle:function(){return a},default:function(){return u},frontMatter:function(){return o},metadata:function(){return i},toc:function(){return c}});var r=t(5893),s=t(1151);t(4866),t(5162);const o={title:"parquet",slug:"parquet",type:"processor",status:"deprecated",categories:["Parsing"],name:"parquet"},a=void 0,i={id:"components/processors/parquet",title:"parquet",description:"\x3c!--",source:"@site/docs/components/processors/parquet.md",sourceDirName:"components/processors",slug:"/components/processors/parquet",permalink:"/bento/docs/components/processors/parquet",draft:!1,unlisted:!1,editUrl:"https://github.com/warpstreamlabs/bento/edit/main/website/docs/components/processors/parquet.md",tags:[],version:"current",frontMatter:{title:"parquet",slug:"parquet",type:"processor",status:"deprecated",categories:["Parsing"],name:"parquet"},sidebar:"docs",previous:{title:"xml",permalink:"/bento/docs/components/processors/xml"},next:{title:"sql",permalink:"/bento/docs/components/processors/sql"}},l={},c=[{value:"Alternatives",id:"alternatives",level:3},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"Defining the Schema",id:"defining-the-schema",level:3},{value:"Fields",id:"fields",level:2},{value:"<code>operator</code>",id:"operator",level:3},{value:"<code>compression</code>",id:"compression",level:3},{value:"<code>schema_file</code>",id:"schema_file",level:3},{value:"<code>schema</code>",id:"schema",level:3}];function d(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.admonition,{title:"DEPRECATED",type:"warning",children:(0,r.jsxs)(n.p,{children:["This component is deprecated and will be removed in the next major version release. Please consider moving onto ",(0,r.jsx)(n.a,{href:"#alternatives",children:"alternative components"}),"."]})}),"\n",(0,r.jsxs)(n.p,{children:["Converts batches of documents to or from ",(0,r.jsx)(n.a,{href:"https://parquet.apache.org/docs/",children:"Parquet files"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Introduced in version 3.62.0."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:'# Config fields, showing default values\nlabel: ""\nparquet:\n  operator: "" # No default (required)\n  compression: snappy\n  schema_file: schemas/foo.json # No default (optional)\n  schema: |- # No default (optional)\n    {\n      "Tag": "name=root, repetitiontype=REQUIRED",\n      "Fields": [\n        {"Tag":"name=name,inname=NameIn,type=BYTE_ARRAY,convertedtype=UTF8, repetitiontype=REQUIRED"},\n        {"Tag":"name=age,inname=Age,type=INT32,repetitiontype=REQUIRED"}\n      ]\n    }\n'})}),"\n",(0,r.jsx)(n.h3,{id:"alternatives",children:"Alternatives"}),"\n",(0,r.jsxs)(n.p,{children:["This processor is now deprecated, it's recommended that you use the new ",(0,r.jsx)(n.a,{href:"/docs/components/processors/parquet_decode",children:(0,r.jsx)(n.code,{children:"parquet_decode"})})," and ",(0,r.jsx)(n.a,{href:"/docs/components/processors/parquet_encode",children:(0,r.jsx)(n.code,{children:"parquet_encode"})})," processors as they provide a number of advantages, the most important of which is better error messages for when schemas are mismatched or files could not be consumed."]}),"\n",(0,r.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsxs)(n.p,{children:["This processor is experimental and the error messages that it provides are often vague and unhelpful. An error message of the form ",(0,r.jsx)(n.code,{children:"interface {} is nil, not <value type>"})," implies that a field of the given type was expected but not found in the processed message when writing parquet files."]}),"\n",(0,r.jsx)(n.p,{children:"Unfortunately the name of the field will sometimes be missing from the error, in which case it's worth double checking the schema you provided to make sure that there are no typos in the field names, and if that doesn't reveal the issue it can help to mark fields as OPTIONAL in the schema and gradually change them back to REQUIRED until the error returns."}),"\n",(0,r.jsx)(n.h3,{id:"defining-the-schema",children:"Defining the Schema"}),"\n",(0,r.jsx)(n.p,{children:"The schema must be specified as a JSON string, containing an object that describes the fields expected at the root of each document. Each field can itself have more fields defined, allowing for nested structures:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Tag": "name=root, repetitiontype=REQUIRED",\n  "Fields": [\n    {"Tag": "name=name, inname=NameIn, type=BYTE_ARRAY, convertedtype=UTF8, repetitiontype=REQUIRED"},\n    {"Tag": "name=age, inname=Age, type=INT32, repetitiontype=REQUIRED"},\n    {"Tag": "name=id, inname=Id, type=INT64, repetitiontype=REQUIRED"},\n    {"Tag": "name=weight, inname=Weight, type=FLOAT, repetitiontype=REQUIRED"},\n    {\n      "Tag": "name=favPokemon, inname=FavPokemon, type=LIST, repetitiontype=OPTIONAL",\n      "Fields": [\n        {"Tag": "name=name, inname=PokeName, type=BYTE_ARRAY, convertedtype=UTF8, repetitiontype=REQUIRED"},\n        {"Tag": "name=coolness, inname=Coolness, type=FLOAT, repetitiontype=REQUIRED"}\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["A schema can be derived from a source file using ",(0,r.jsx)(n.a,{href:"https://github.com/xitongsys/parquet-go/tree/master/tool/parquet-tools",children:"https://github.com/xitongsys/parquet-go/tree/master/tool/parquet-tools"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"./parquet-tools -cmd schema -file foo.parquet\n"})}),"\n",(0,r.jsx)(n.h2,{id:"fields",children:"Fields"}),"\n",(0,r.jsx)(n.h3,{id:"operator",children:(0,r.jsx)(n.code,{children:"operator"})}),"\n",(0,r.jsx)(n.p,{children:"Determines whether the processor converts messages into a parquet file or expands parquet files into messages. Converting into JSON allows subsequent processors and mappings to convert the data into any other format."}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"})]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Option"}),(0,r.jsx)(n.th,{children:"Summary"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"from_json"})}),(0,r.jsx)(n.td,{children:"Compress a batch of JSON documents into a file."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"to_json"})}),(0,r.jsx)(n.td,{children:"Expand a file into one or more JSON messages."})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"compression",children:(0,r.jsx)(n.code,{children:"compression"})}),"\n",(0,r.jsx)(n.p,{children:"The type of compression to use when writing parquet files, this field is ignored when consuming parquet files."}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"}),(0,r.jsx)(n.br,{}),"\n","Default: ",(0,r.jsx)(n.code,{children:'"snappy"'}),(0,r.jsx)(n.br,{}),"\n","Options: ",(0,r.jsx)(n.code,{children:"uncompressed"}),", ",(0,r.jsx)(n.code,{children:"snappy"}),", ",(0,r.jsx)(n.code,{children:"gzip"}),", ",(0,r.jsx)(n.code,{children:"lz4"}),", ",(0,r.jsx)(n.code,{children:"zstd"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"schema_file",children:(0,r.jsx)(n.code,{children:"schema_file"})}),"\n",(0,r.jsxs)(n.p,{children:["A file path containing a schema used to describe the parquet files being generated or consumed, the format of the schema is a JSON document detailing the tag and fields of documents. The schema can be found at: ",(0,r.jsx)(n.a,{href:"https://pkg.go.dev/github.com/xitongsys/parquet-go#readme-json",children:"https://pkg.go.dev/github.com/xitongsys/parquet-go#readme-json"}),". Either a ",(0,r.jsx)(n.code,{children:"schema_file"})," or ",(0,r.jsx)(n.code,{children:"schema"})," field must be specified when creating Parquet files via the ",(0,r.jsx)(n.code,{children:"from_json"})," operator."]}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:"# Examples\n\nschema_file: schemas/foo.json\n"})}),"\n",(0,r.jsx)(n.h3,{id:"schema",children:(0,r.jsx)(n.code,{children:"schema"})}),"\n",(0,r.jsxs)(n.p,{children:["A schema used to describe the parquet files being generated or consumed, the format of the schema is a JSON document detailing the tag and fields of documents. The schema can be found at: ",(0,r.jsx)(n.a,{href:"https://pkg.go.dev/github.com/xitongsys/parquet-go#readme-json",children:"https://pkg.go.dev/github.com/xitongsys/parquet-go#readme-json"}),". Either a ",(0,r.jsx)(n.code,{children:"schema_file"})," or ",(0,r.jsx)(n.code,{children:"schema"})," field must be specified when creating Parquet files via the ",(0,r.jsx)(n.code,{children:"from_json"})," operator."]}),"\n",(0,r.jsxs)(n.p,{children:["Type: ",(0,r.jsx)(n.code,{children:"string"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:'# Examples\n\nschema: |-\n  {\n    "Tag": "name=root, repetitiontype=REQUIRED",\n    "Fields": [\n      {"Tag":"name=name,inname=NameIn,type=BYTE_ARRAY,convertedtype=UTF8, repetitiontype=REQUIRED"},\n      {"Tag":"name=age,inname=Age,type=INT32,repetitiontype=REQUIRED"}\n    ]\n  }\n'})})]})}function u(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},5162:function(e,n,t){t.d(n,{Z:function(){return a}});t(7294);var r=t(6010),s={tabItem:"tabItem_Ymn6"},o=t(5893);function a(e){let{children:n,hidden:t,className:a}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.Z)(s.tabItem,a),hidden:t,children:n})}},4866:function(e,n,t){t.d(n,{Z:function(){return T}});var r=t(7294),s=t(6010),o=t(2466),a=t(6550),i=t(469),l=t(1980),c=t(7392),d=t(12);function u(e){var n,t;return null!=(n=null==(t=r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?n:[]}function h(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=null!=n?n:function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:s}}=e;return{value:n,label:t,attributes:r,default:s}}))}(t);return function(e){const n=(0,c.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const s=(0,a.k6)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:t});return[(0,l._X)(o),(0,r.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(s.location.search);n.set(o,e),s.replace({...s.location,search:n.toString()})}),[o,s])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,o=h(e),[a,l]=(0,r.useState)((()=>function(e){var n;let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:r}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+r.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}const s=null!=(n=r.find((e=>e.default)))?n:r[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:o}))),[c,u]=m({queryString:t,groupId:s}),[f,g]=function(e){let{groupId:n}=e;const t=function(e){return e?"docusaurus.tab."+e:null}(n),[s,o]=(0,d.Nk)(t);return[s,(0,r.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:s}),x=(()=>{const e=null!=c?c:f;return p({value:e,tabValues:o})?e:null})();(0,i.Z)((()=>{x&&l(x)}),[x]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error("Can't select invalid tab value="+e);l(e),u(e),g(e)}),[u,g,o]),tabValues:o}}var g=t(2389),x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"},b=t(5893);function j(e){let{className:n,block:t,selectedValue:r,selectValue:a,tabValues:i}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.o5)(),d=e=>{const n=e.currentTarget,t=l.indexOf(n),s=i[t].value;s!==r&&(c(n),a(s))},u=e=>{var n;let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{var r;const n=l.indexOf(e.currentTarget)+1;t=null!=(r=l[n])?r:l[0];break}case"ArrowLeft":{var s;const n=l.indexOf(e.currentTarget)-1;t=null!=(s=l[n])?s:l[l.length-1];break}}null==(n=t)||n.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":t},n),children:i.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>l.push(e),onKeyDown:u,onClick:d,...o,className:(0,s.Z)("tabs__item",x.tabItem,null==o?void 0:o.className,{"tabs__item--active":r===n}),children:null!=t?t:n},n)}))})}function v(e){let{lazy:n,children:t,selectedValue:s}=e;const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===s));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function y(e){const n=f(e);return(0,b.jsxs)("div",{className:(0,s.Z)("tabs-container",x.tabList),children:[(0,b.jsx)(j,{...e,...n}),(0,b.jsx)(v,{...e,...n})]})}function T(e){const n=(0,g.Z)();return(0,b.jsx)(y,{...e,children:u(e.children)},String(n))}},1151:function(e,n,t){t.d(n,{Z:function(){return i},a:function(){return a}});var r=t(7294);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);